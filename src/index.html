<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="blog-demo-gpt-s-viewability-and-impression-timing">
  <title>blog-demo-gpt-s-viewability-and-impression-timing</title>
  <link rel="stylesheet" href="assets/css/normalize.css">
  <link rel="stylesheet" href="assets/css/main.css">
  <script async src='https://securepubads.g.doubleclick.net/tag/js/gpt.js'></script>
  <script>window.googletag = window.googletag || {cmd: []};</script>
  <script src="assets/js/demotag.js"></script>
  <script src="assets/js/gpt-slot-definitions.js"></script>
  <script src="assets/js/main.js"></script>
</head>
<body>
  <div class="grid-container">
    <!-- site header -->
    <header class="grid-header">
      <nav class="navbar">
        <div class="navbar-brand">
          <h1><a href="./index.html">GPT's Event Lifecycle</a></h1>
          <p>GPT's Viewability and Impression Timing</p>
        </div>
        <ul class="navbar-items">
          <li class="navbar-item">
            <a href="https://github.com/xkema/blog-demo-gpt-s-viewability-and-impression-timing" target="_blank">@github</a>
          </li>
        </ul>
      </nav>
    </header>
    <!-- timelines wrapper -->
    <section class="grid-entrance">
      <h1>Before You Begin!</h1>
      <p><b>Ad Blocker Users</b>: You should always be using ad/tracker blockers. <u>But just for this demo you must disable ad blockers temporarily</u>. Because this demo is all about ads.</p>
      <p><b>Users Without Ad Blocker</b>: You should definitely use an ad/tracker blocker for personal stuff! See <a href="#privacy-matters">links</a> at the end of the page.</p>
    </section>
    <!-- timelines wrapper -->
    <section class="grid-graph">
      <h1>Event Timelines</h1>
      <div class="timelines"><!-- timelines --></div>
    </section>
    <!-- main content -->
    <main class="grid-main">
      <h1>GPT Lifecycle Events</h1>
      <p>A simple playground page for GPT lifecycle events for display ads.</p>
      <h2>Customization Form</h2>
      <!-- customization form -->
      <form class="page-settings">
        <div class="option">
          <label for="enableSingleRequest">enableSingleRequest</label>
          <div class="input-wrapper"><input type="checkbox" name="enableSingleRequest" id="enableSingleRequest"></div>
          <div class="current-value"><span>disabled</span></div> 
        </div>
        <div class="option">
          <label for="enableLazyLoad">enableLazyLoad</label>
          <div class="input-wrapper"><input type="checkbox" name="enableLazyLoad" id="enableLazyLoad"></div>
          <div class="current-value"><span>disabled</span></div> 
        </div>
        <div class="option sub-option">
          <label for="fetchMarginPercent">fetchMarginPercent</label>
          <div class="input-wrapper"><input type="range" min="0" max="500" value="0" step="100" name="fetchMarginPercent" id="fetchMarginPercent"></div>
          <div class="current-value"><span>0</span></div> 
        </div>
        <div class="option sub-option">
          <label for="renderMarginPercent">renderMarginPercent</label>
          <div class="input-wrapper"><input type="range" min="0" max="500" value="0" step="100" name="renderMarginPercent" id="renderMarginPercent"></div>
          <div class="current-value"><span>0</span></div> 
        </div>
        <div class="submit">
          <button type="submit">Reload Page</button>
        </div>
      </form>
      <!-- customization form details and description -->
      <h2>Description</h2>
      <div class="form-info">
        <p>Use the form above to change GPT options. Clicking submit button will reload the page with selected configuration.</p>
        <p>Follow timelines to observe what changes on selected GPT configuration. Here are some hints for GPT options available:</p>
        <ul>
          <li>
            <p><code>enableSingleRequest</code> Enables GPT's single request mode. <a href="https://developers.google.com/doubleclick-gpt/reference#boolean-enablesinglerequest" target="_blank">@docs</a></p>
            <p>author notes</p>
          </li>
          <li>
            <p><code>enableLazyLoad</code> Enables GPT's build in lazyloading feature. <a href="https://developers.google.com/doubleclick-gpt/reference#googletag.PubAdsService_enableLazyLoad" target="_blank">@docs</a></p>
            <p>author notes</p>
          </li>
          <li>
            <p><code>fetchMarginPercent</code> Start fetching before entering viewport. <a href="https://developers.google.com/doubleclick-gpt/reference#googletag.PubAdsService_enableLazyLoad" target="_blank">@docs</a></p>
            <p>author notes</p>
          </li>
          <li>
            <p><code>renderMarginPercent</code> Start rendering before entering viewport. <a href="https://developers.google.com/doubleclick-gpt/reference#googletag.PubAdsService_enableLazyLoad" target="_blank">@docs</a></p>
            <p>author notes</p>
          </li>
        </ul>
      </div>
      <!-- predefined setups and description -->
      <h2>Predefined setups</h2>
      <div class="predefined-setups">
        <ul>
          <li>
            <p><a href="./index.html?enableLazyLoad=on&fetchMarginPercent=0&renderMarginPercent=0">GPT "enableLazyLoad" (default)</a></p>
            <p>This is the basic setup for GPT's built-in <code>enableLazyLoad</code> feature. Expected outcome is empty timelines until each slot enters into the viewport. Each timeline will be filled individually at this setup because <code>enableSingleRequest</code> option is not enabled.</p>
            <p>There will be 2 separate network requests for each ad which you can see at your devtool's network panel by filtering requests with <code>ads?</code> keyword.</p>
          </li>
          <li>
            <p><a href="./index.html?enableSingleRequest=on&enableLazyLoad=on&fetchMarginPercent=0&renderMarginPercent=0">GPT "enableLazyLoad" with "enableSingleRequest" enabled</a></p>
            <p>When <code>enableSingleRequest</code> is enabled along with <code>enableLazyLoad</code> option, individual behaviour above will be interrupted. With this setup ad requests will be merged by GPT.</p>
            <p>This time there will be a single network request for all ad slots at devtool's network panel. (Again, use <code>ads?</code> keyword as a filter.)</p>
            <p>A further note, lazy fetching with <abbr title="Single Request Architecture">SRA</abbr> (<code>enableSingleRequest</code>) will only workif all slots are out of viewport at initial page load. Otherwise both slots will be fetched at page load.</p>
            <p><b>Hint</b>: Resize your browser window to observe both. If both slots are out of margin, there will be 2 empty timelines initially. Else there will be a filled timelime for top slot and a <code>slotRequested</code> <small>&</small> <code>slotResponseReceived</code> couple for bottom slot.</p>
          </li>
        </ul>
      </div>
    </main>
    <aside class="grid-aside-top">
      <!-- top ad description -->
      <h1>Top Slot</h1>
      <div>
        <p>This page has 2 ad slots on sidebar element. One is at top <code>sidebar-top-slot</code> and the other one is at bottom <code>sidebar-bottom-slot</code>.</p>
        <p>There is a seperator between these two ad slots to push bottom ad out of first viewport. (to observe lazyloading behaviour clearly)</p>
      </div>
      <!-- top ad -->
      <div id='sidebar-top-slot'>
        <script>
          googletag.cmd.push(function () {
            googletag.display('sidebar-top-slot');
          });
        </script>
      </div>
    </aside>
    <aside class="grid-aside-middle">
      <div class="sidebar-separator">
        &uarr;<br>separator<br>&darr;
      </div>
    </aside>
    <aside class="grid-aside-bottom">
      <h1>Bottom Slot</h1>
      <p>This slot will be used to observe lazyload behaviour.</p>
      <!-- bottom ad -->
      <div id='sidebar-bottom-slot'>
        <script>
          googletag.cmd.push(function () {
            googletag.display('sidebar-bottom-slot');
          });
        </script>
      </div>
    </aside>
    <section class="grid-privacy">
      <div class="privacy-matters-wrapper">
        <h1 id="privacy-matters">Ad/Tracker Blockers I Use</h1>
        <ul>
          <li><a href="https://getadblock.com/" target="_blank">getadblock.com</a></li>
          <li><a href="https://duckduckgo.com/" target="_blank">duckduckgo.com</a></li>
          <li><a href="https://www.mozilla.org/en-US/firefox/" target="_blank">mozilla.org/en-US/firefox</a></li>
          <li><a href="https://brave.com/" target="_blank">brave.com</a></li>
        </ul>
      </div>
    </section>
    <footer class="grid-footer">
      <div class="outro">
        <a href="https://github.com/xkema/blog-demo-gpt-s-viewability-and-impression-timing" target="_blank">@github</a>
      </div>
    </footer>
  </div>
</body>
</html>


